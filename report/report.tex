\documentclass[11pt]{report}
\usepackage{multicol}
\usepackage{svg}
\usepackage[french]{babel}
\usepackage[T1]{fontenc}
\usepackage[a4paper, margin=1cm, top=-1cm, bottom=-1cm]{geometry}

\newcommand{\mychapter}[2]{
    \setcounter{chapter}{#1}
    \setcounter{section}{0}
    \chapter*{#2}
    \addcontentsline{toc}{chapter}{#2}
}

\title{
    {
        \parbox{\textwidth}{
            \textbf{\textsc{\Large Introduction aux méthodes numériques et projet}}
            \vskip 4pt \hrule height 4pt width \hsize \vskip 4pt
            \hfill \textbf{\textsc{\normalsize Année académique 2023-2024}}\\
            \vspace{0.1\textheight} \leavevmode
            \begin{center}
                \textbf{\Huge Production d'$H_2$ par reformage catalytique\\ de $CH_4$ et captage de $CO_2$\\ dans un réacteur.}
            \end{center}
        }
        \vfill \leavevmode
        \includesvg[width=0.75\textwidth]{"image/3d_CO"}
        \parbox{\textwidth}{
            \includesvg[height=0.025\textheight]{"image/fsa_text"}
            \hspace{-0.4em}
            \textbf{\normalsize \hfill \today}
            \vskip 4pt \hrule height 4pt width \hsize \vskip 4pt
            \textbf{
                \normalsize
                \begin{tabular}{p{0.295\textwidth}p{0.295\textwidth}p{0.295\textwidth}}
                    \hfil \textsc{Moreci} Raffaele & \hfil \textsc{Odding} Luca & \hfil \textsc{Lindsey} Alexandre\\
                    \hfil S2304531                 & \hfil S2303933             & \hfil S2302371
                \end{tabular}
            }
        }
    }
}
\author{}
\date{}

\begin{document}    
    \maketitle

    \newgeometry{margin=1in}
    
    \tableofcontents

    \mychapter{1}{Question 1}
        \section{Méthode de la sécante}
            Notre fonction sécante requiert trois arguments nécessaires au bon fonctionnement de la méthode qui sont :
            \begin{itemize}
                \item $fun$, la fonction dont on recherche les racines,
                \item $x$, un tableau contenant les deux valeurs de $x$ de départ
                \item $tol$, la tolérance qui permet de gérer la précision des résultats
                    (la boucle s'arrète lorsque $abs(x0-x1)>= tol$)
            \end{itemize}
            \par
            Logiquement nous devons donc compromettrefonction la précision pour limiter les calculs
            et donc ne pas mettre une tolérance trop faible.
            Nous avons opté, après une multitude d'essais, pour une valeur de $5\times10^{-4}$ qui nous permet de garder une bonne précision pour un temps d'exécution faible.
            \par
            Nous avons implémenté la fonction en s'assurant tout d'abord que toutes les conditions initiales soient bonnes
            et, pour que la fonction n'itère pas à l'infini,
            nous avons introduit $max\_i$ en arguments $kwargs$ avec une valeur par défaut élevée qui restreint la fonction
            à ne pas faire plus d'itérations que ce nombre tout en laissant une marge afin de ne pas arrêter trop vite l'exécution.
            Après avoir pris nos précautions, une boucle va itérer tant que l'évaluation de la fonction en $x1$ est plus petite ou égale à notre $tol$
            (nous utilisons la tolérance car il est quasiment impossible que la valeur soit exactement égale à $0$ par les méthodes numériques).
            \par
            Nous avons décidé de séparer le calcul du numérateur et du dénominateur :  si le numérateur $y1\times(x1 - x0)$ est égal à $0$,
            $x0$ et $x1$ doivent avoir la même valeur du coup la fonction retourne $-1$ pour indiquer que la fonction ne converge pas.
            Si le dénominateur $y1 - y0$ est égal à $0$, la fonction ne converge pas vu la méthode de la sécante :
            la droite passe par deux points qui forment une droite parallèle à l'abscisse.
            La boucle se finira soit par le non-respect de sa condition ou bien si la boucle fait un nombre anormalement grand d'itérations.
            
        \section{Méthode de la bissection}
            Les arguments sont les mêmes que dans la méthode de la sécante avec la même tolérance de $5\times10^{-4}$ mais sans introduire $max\_i$
            car si les conditions initiales sont respectées, la fonction convergera toujours.
            Nous nous assurons donc que les conditions initiales sont respectées en posant l'hypothèse que la fonctions traitée est continue.
            \par
            Pour se rapprocher de la racine nous allons itérer pendant $k$ itérations égal à\\
            $log_2(\frac{x1-x0}{2{\times}tol})$ comme vu dans le cours.
            Dans cette boucle, on calcule la moyenne des abscisses des deux points qui sera celle de notre nouveau point.
            Si la valeur de la fonction en ce point est positive, on remplace $x1$ (à image positive) par cette moyenne et inversement.
            Après toutes les itérations, la valeur de $xi$ sera la valeur de notre racine.

    \mychapter{2}{Question 2}
        \section{Création d'odefunction}
            Notre fonction $odefunction$ est une fonction qui reçois trois arguments :
            \begin{itemize}
                \item $z$, la distance axiale  du réacteur
                \item $C0$, le tableau avec les valeurs initiales des huit variables d'état :
                    les concentrations initiales en $CH_4$, $H_2O$, $H_2$, $CO$, $CO_2$
                    la conversion fractionnaire $X$,
                    la température $T$
                    et la pression $P$
                \item $mode$ et $param$, qui nous serviront plus tard
            \end{itemize}
            La fonction odefunction calcule la dérivée du tableau $\frac{dC}{dz}$ et retourne ces valeurs.
            Pour plus de clarté et de flexibilité, les constantes ont été placées dans le fichier $constants.py$.
            Certaines constantes sont implémentées sous forme de fonction,
            cela n'est pas optimisé pour le temps mais nous avons opté pour cette option par soucis de lisibilité
            et de flexibilité, ce qui nous a aidé pour la question 3.

        \section{Résolution d'équation différentielle}
            Notre fonction $calculConcentrationEuler$ est une fonction qui suit la méthode d'Euler explicite au premier ordre
            pour résoudre approximativement l'équation contenue dans odefunction.
            Cette fonction prend cinq arguments en entrée :
            \begin{itemize}
                \item $fun$, la fonction à résoudre
                \item $x$, un tableau contenant les bornes pour lesquels l'équation doit être résolue
                \item $y0$, les valeurs initiales de la fonction
                \item $step$, le pas qui est par défault à 5e-8
                \item $mode$ et $param$, qui nous serviront plus tard.
            \end{itemize}
            La fonction renvoie une approximation de la résolution de la fonction.
            \par
            La fonction $solve\_ivp$ prend les mêmes arguments que $calculConcentrationEuler$. 
            Nous avons aussi modifier les valeurs de la tolérance relative $rtol$ et de la taille maximum du pas $max\_step$
            qui ont tous deux pour but d'augmenter la précision de notre approximation.
            Nous avons choisi notre $rtol$ égale à $5\times10^{-7}$ et notre max-step égale à $1\times10^{-6}$,
            ces valeurs sont les meilleurs compromis que nous avons trouvé entre une précision correcte
            et une durée d'exécution minimale.
            \par
            \begin{figure}
                \centering
                \begin{tabular}{|r|r|r|}
                    \hline
                    $tol$   & Temps             & Taux d'erreur\\
                    \hline
                    $5e-1$  & $19.7\ \mu s$        & $61.41\%$\\
                    $5e-2$  & $20.9\ \mu s$        & $61.41\%$\\
                    $5e-7$  & $9.32\ s$         & $64.52\%$\\
                    $5e-8$  & $1\ min\ 56\ s$   & $0.98\%$\\
                    $5e-9$  & $20\ min\ 21\ s$  & $0.01\%$\\
                    $5e-10$ & $3\ h\ 3\ min$    & (((valeur)))\\
                    \hline
                \end{tabular}
                \caption{Taux d'erreur par tolérance}
                \label{tab:tol}
            \end{figure}
            \par
            Après plusieurs tests, nous pouvons conclure que $solve\_ivp$ est beaucoup plus efficace que notre fonction.
            Notre fonction prend environs (((x minutes))) pour résoudre l'équation tandis que $solve\_ivp$ ne prend que (((x secondes))),
            $solve\_ivp$ va donc (((x))) fois plus vite.
            Ceci est probablement dû au fait que $solve\_ivp$ utilise un pas variable mais pas notre fonction.
            $solve\_ivp$ est également beaucoup plus précis puisqu'elle utilise une méthode d'ordre suprérieur.
            Nous concluons que $solve\_ivp$ est beaucoup plus efficace, que ce soit pour le temps d'exécution que pour la précision.
    \mychapter{3}{Question 3}
        Pour cette question 3, nous avons introduit les arguments optionnels $mode$ et $param$ à odefunction.
        $mode$ nous permet de tester différentes conditions de notre réacteur.
        Lorsque $mode$ est à $0$, le système fonctionne avec les paramètres de base,
        lorsqu'il est à $1$, le modèle ne prend pas en compote la carbonatation,
        lorsqu'il est à $2$, on remplace $us$ par la valeur de $param$
        et lorsqu'il est à $3$, on remplace $ug$ par la valeur de $param$.
        \section{Modèle sans capture de $CO_2$}
            Afin de comparer un modèle de réacteur avec et sans capture de $CO_2$,
            nous avons mis le mode de odefunction à 3, soit un modèle sans capture de $CO_2$.
            Pour simuler ceci, nous avons remplacé la conversion fractionnaire ($X$),
            le taux de consommation de $CO_2$ par carbonatation ($rcbn$)
            et la vitesse d'entré du $CaO$ dans le réacteur ($us$)
            par $0$ car ils n'interviennent plus dans le modèle sans capture de $CO_2$.
            \par
            (((EXPLIQUER GRAPHIQUES)))

            \begin{figure}[h]
                \centering
                \begin{tabular}{|c|r|r|r|}
                    \hline
                    Nom             & $mode\ 0$ \hfill          & $mode\ 1$ \hfill   & Différence\\
                    \hline
                    $CH_4$          & $0,00417\ \frac{mol}{L}$  & $0,00478\ \frac{mol}{L}$  & $+14,7\%$\\
                    $H_2$           & $0,02322\ \frac{mol}{L}$  & $0,02302\ \frac{mol}{L}$  & $-0.9\%$\\
                    $CO$            & $0,00235\ \frac{mol}{L}$  & $0,00250\ \frac{mol}{L}$  & $+6.5\%$\\
                    $CO_2$          & $0,00344\ \frac{mol}{L}$  & $0,00387\ \frac{mol}{L}$  & $+12.6\%$\\
                    $T$\textdegree  & $920,23\ K$               & $915,85\ K$               & $-0.5\%$\\
                    \hline
                \end{tabular}
                \caption{Effet de la carbonatation sur le modèle}
                \label{tab:carb}
            \end{figure}

        \section{Effet du flux de CaO sur le modèle}
            Pour analyser l'effet du flux d'entré de $CaO$,
            nous avons fait varier la valeur de $us$ à l'aide du mode 2.
            Nous l'avons fait varié de $0.001$ à $0.025\ m.s^{-1}$.
            \par
            (((EXPLIQUER GRAPHIQUES)))
        
        \section{Effet du flux des gaz sur le modèles}
            Pour analyser le flux des gaz, nous avons fait varier $ug$ à l'aide du mode 3
            en changeant la valeur de $1$ à $3\ m.s^{-1}$ avec un pas de $0.5$.
            \par
            (((EXPLIQUER GRAPHIQUES)))
        
        \section{Effet de la composition du gaz d'entrer sur le modèle}
            Dans le but de modifier les compositions initiales de gaz,
            nous avons fait varier le rapport des concentrations initiales en $H_2O$ et $CH_4$ de $3$ à $0.3$.
            \par
            (((EXPLIQUER GRAPHIQUES)))

    \mychapter{4}{Question 4}
        \section{Fonction d'optimisation}
            Notre fonction $optimise\_us$ est une fonction qui a pour but d'optimiser $us$
            par rapport a un certain pourcentage de $CO_2$ en sortie,
            cette fonction prend 5 arguments en entrée le pourcentage de $CO_2$ dans
            le gaz de sortie $Y$, $us$, le tableau des conditions initiales $C0$ et
            les deux paramètres optionnels $mode\_$ et $param1$ qui sont utilisés pour la sous question 3.
            Cette fonction résout odefunction grâce à $solve\_ivp$ et retourne la concentration
            finale de $CO_2$ divisé par la somme des concentration finale de $CH_4$, $H_2$,
            $CO$ et de $CO_2$ le tout soustrait par $Y$ pour corriger le décalage vertical.
        \section{Recherche du us optimale}
            Dans ce notre cas, nous devons trouvez la valeur optimale de $us$ pour une concentration
            en $CO_2$ de $7.5\%$.
            En voici une illustration graphique où est représenté $us - Y$ en fonction
            du pourcentage de $CO_2$ parmis les gaz secs. Notre fonction 'Hybrid'
            nous renvoit une racine située en $x = 0.101$ soit $10.1\%$

            (((Graphique manquant)))

            La méthode utilisée pour trouver la racine est une méthode hybride qui est simplement
            la méthode de la sécante légèrement modifiée : si la sécante ne converge pas dû aux
            valeurs de la fonction en $x0$ et $x1$ égales,
            alors on s'inspire de la méthode de la bissection pour  débloquer la situation.
            Ce faisant, on bénéficie de la précision accrue de la méthode de la sécante
            ainsi que sa vitesse bien supérieure a la bissection mais si ladite erreur se produit,
            on effectue la moyenne de ces deux points et on utilise ce nouveau point pour relancer
            la fonction sécante.
        \section{Effet de la température sur le us optimale}
            Le graphique ci-dessous illustre la variation du us optimal en fonction de la température.
            Il est clair que $us$ dépend de la température, nous le voyons décroitre très rapidement,
            presque exponentiellement. Donc, plus la température est élevée, plus la vitesse d'entrée
            optimale des gaz pour un pourcentage de $CO_2$ donné est petite.
            (((Graphique manquant)))

\end{document}